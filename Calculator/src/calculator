/*
 ============================================================================
 Name        : Calculator.c
 Author      : Andryfaciy
 Version     : 3
 Copyright   : maya and only maya
 Description : Calculator with operations for calculating factorial, addition, difference, multiplication, exponentiation and division.
It can also count the difference, sum and scalar product of vectors.
 ============================================================================
 */
#include <stdio.h>
#include <stdlib.h>

float factorial(int n)  //function for calculating the factorial(n-number)
{
    float res;
    int i;
    res = 1;
    i = 1;
    while (i != (n + 1))
    {
        res = res * i;
        i++;
    }
    return(res);
}

float stepen(float x, float y)  //function for calculating the degree(x-number, y-degree)
{
    float res;
    int i;
    res = 1;
    i = 0;
    while (i < y)
    {
        res = res * x;
        i++;
    }
    if (y < 0)
    {
        res = 1/res;
    }
    return(res);
}

int main(int argc, char *argv[])
    {
    setvbuf(stdout, NULL, _IONBF, 0);
    setvbuf(stderr, NULL, _IONBF, 0);
    FILE *input, *output;
    float *vector1,*vector2, result,a,b;
    int m, size;
    char choose, operation, inputfile[100], outputfile[100];
    m = 1;
    while(m == 1){
printf("Enter input file name: ");
	scanf("%s", inputfile);
	printf("Enter output file name: ");
	scanf("%s", outputfile);
	input = fopen(inputfile, "r");
	output = fopen(outputfile, "w");
	fscanf(input, "%c", &choose);

switch(choose){
    case's':   // choosing work with numbers
    	fscanf(input, " %f",&a);
    	        fscanf(input, " %c", &operation);
        switch(operation){
        case '+': // addition
		fscanf(input, " %f %f",&a,&b);
		fprintf(output, "(%.2f + %.2f) = %.2f", a, b, a+b);
		break;
	case '-':
		fscanf(input, " %f %f",&a,&b);
		fprintf(output, "(%.2f - %.2f) = %.2f", a, b, a-b);
		break;
	case '*':
		fscanf(input, " %f %f",&a,&b);
		fprintf(output, "(%.2f * %.2f) = %.2f", a, b, a*b);
		break;
	case '/':
		fscanf(input, " %f %f",&a,&b);
		if (b != 0) fprintf(output, "(%.2f / %.2f) = %.2f", a, b, a/b);
		else fprintf(output, "This operation is not valid");
		break;
	case '^':
		fscanf(input, " %f %f",&a,&b);
		fprintf(output, "%.2f ^ %.2f = %.2f", a, b, power(a,b));
		break;
	case '!':
		fscanf(input, "%f",&a);
		if (a >= 0) fprintf(output, "%.0f! = %.0f", a, factorial(a));
		else fprintf(output, "This operation is not valid");
		break;
	default:
		fprintf(output, "Unknown operation");
	}
	break;
        case 'v': // choosing how to work with vectors
                result = 0;
    	            fscanf(input, "%i", &size);
    	            vector1 = malloc(size*sizeof(int));
    	            vector2 = malloc(size*sizeof(int));
    	        for (int i=0; i < size; i++)
    	        	fscanf(input, "%f", &vector1[i]);
    	             switch (operation){
    	        case('+'):
    	            for (int i=0; i < size; i++)
    	            	fprintf(output, "%.2f ", vector1[i]+vector2[i]);
    	            break;
    	        case('-'):
    	            for (int i=0; i < size; i++)
    	            	fprintf(output, "%.2f ", vector1[i]-vector2[i]);
    	            break;
    	        case('*'):
    	            for (int i=0; i < size; i++) result = vector1[i] * vector2[i] + result;
    	            	fprintf(output, "%.2f ", result);
    	            break;
    	                	        for (int i=0; i < size; i++)
    	                	        	fscanf(input, "%f", &vector2[i]);

    	        free(vector1); // free memory
    	        free(vector2);
    }
    	        printf("\nDo you want to continue? (0 - NO, 1 - YES)\n"); //repeating the calculator operation
    	                       fscanf(input, "%i",&m);

		   fclose(input);
		   fclose(output);
}
    return 0;
    }
    }
